# 第四部分 计算机视觉

[TOC]

## 第10章

从一个发光体发出的光投射到场景上，然后一部分光**反射**到观察者的眼中，从而产生对那个场景的感知。

> 反射回眼中或者摄像机中的光线与投射到场景上的光照度以及反射率（一种材料特性）有关。

### 10.1 光的谱表示

白光由几种颜色的光混合而成，其中每一种颜色都是拥有单一频率或波长的**电磁波**。

可见光波长范围取决于观察条件和观察者个体，通常认为是400~700nm。

---

可见光谱列表（波长区间为常用的近似值），按照波长降序排列：

| 颜色 | 波长（nm） | 频率（THz） |
| :--: | :--------: | :---------: |
| 红色 |  620–750   |   400-484   |
| 橙色 |  590–620   |   484-508   |
| 黄色 |  570–590   |   508-526   |
| 绿色 |  495-570   |   526-606   |
| 青色 |  476-495   |   606-630   |
| 蓝色 |  450-475   |   631-668   |
| 紫色 |  380-450   |   668-789   |

通常所见的光都是含有多个波长的混合光，可用函数$E(\lambda)$表示，描述光强度与波长$\lambda$的关系。激光器发射出来的光是单色光，只有单一波长。

白炽光是由**炽热物体**（如太阳、灯丝）发出的光。在物理学中被模型化为黑体或普朗克辐射：

> $$
> E(\lambda)=\frac{2hc^2}{\lambda^5(e^{hc/k\lambda T}-1)}Wsr^{-1}m^{-2}m^{-1}
> $$

#### 10.1.1 吸收

地球表面的太阳光光谱与太阳黑体光谱明显不同，因为阳光中许多波长被大气层吸收。

透光率代表**穿透过的部分光**，可由比尔定律描述：

> $$
> T(\lambda)=10^{-A(\lambda)d}
> $$
>
> 透光率与吸收率相反。

当在水下拍摄图像时，需考虑不同波长光的吸收率差异。

#### 10.1.2 反射

从物体表面反射回来的光，其**亮度**的光谱（这里指的是辐射度量）如下：

> $$
> L(\lambda)=E(\lambda)R(\lambda)Wm^{-2}
> $$
>
> 其中，$E​$是入射光的照度；$R\in[0,1]​$是反射率或表面反射比，是波长的函数。

### 10.2 色彩

**色彩**是对由眼睛视网膜及其附属神经系统的活动所产生的所有**感觉**的一般称谓。

人对光的感知基于**明亮度**和**色彩**等主观参数。

人眼有两种敏感细胞，**视锥细胞**对特别的颜色有反应，提供正常的白天的视觉。**视杆细胞**更敏感，但只对光强起反应，并且在夜间发挥作用（因为夜晚没有颜色视觉）。

一个特定波长光波的明亮程度被称为**亮度**。测量单位（光度量）是流明/瓦（lm/W）。

> 亮度是一种光度量单位，考虑的是观察者的视觉感受。

人是三色视者，有三种类型的锥形感光器对光谱的不同部分作出反应。分别被称为长（L）、中（M）、短（S）型，对应红、绿、蓝型（三原色）。

---

给定物体亮度$L(\lambda)$，可以得到三种椎体各自的特定响应：

> $$
> \rho=\int_\lambda L(\lambda)M_r(\lambda)d\lambda\\
> \gamma=\int_\lambda L(\lambda)M_g(\lambda)d\lambda\\
> \beta=\int_\lambda L(\lambda)M_b(\lambda)d\lambda
> $$
>
> 其中$M_r(\lambda)、M_g(\lambda)、M_b(\lambda)​$分别是**1931CIE标准**给出的红、绿、蓝三种椎体的光谱反应。

只用三个参数表示任意一段连续光谱的结果是，许多不同光谱能量分布会产生相同的视觉刺激，称为条件等色。

> 任意的视觉刺激可以仅仅通过三种单色的刺激混合产生（近似）。

---

**CIE**（国际照明委员会）1976的三原色：

|                  |  红   |  绿   |  蓝   |
| :--------------: | :---: | :---: | :---: |
| $\lambda $（nm） | 700.0 | 546.1 | 435.8 |

#### 10.2.1 颜色再造

电脑或电视的显示屏能在每个像素上产生可变数量的三原色。

---

为了使三原色广元合成的颜色与单色光产生的颜色感受一致，只需简单地将椎体对单色光刺激的反应进行线性变换：

> $$
> \left(\begin{array}{matix}
> R\\
> G\\
> B
> \end{array}\right)=
> L(\lambda)
> {\left(\begin{array}{matix}
> M_r(\lambda_r) & M_r(\lambda_g) & M_r(\lambda_b)\\
> M_g(\lambda_r) & M_g(\lambda_g) & M_g(\lambda_b)\\
> M_b(\lambda_r) & M_b(\lambda_g) & M_b(\lambda_b)
> \end{array}\right)}^{-1}
> \left(\begin{array}{matix}
> M_r(\lambda_s)\\
> M_g(\lambda_s)\\
> M_b(\lambda_s)
> \end{array}\right)
> $$
>
> 变换矩阵是常量，但是依赖于红、绿、蓝三种椎体的光谱反应$M_r(\lambda)，M_g(\lambda)，M_b(\lambda)$。

这是三色匹配的基础（理论基础）。

---

实际中，人们通过**颜色匹配实验**获得三原色的刺激量（光强由人主观调节）。对于标准CIE三原色，可以通过颜色匹配函数（该函数已被表格化）获得：

> $$
> \left(\begin{array}{matix}
> R\\
> G\\
> B
> \end{array}\right)=
> \left(\begin{array}{matix}
> \overline r(\lambda_s)\\
> \overline g(\lambda_s)\\
> \overline b(\lambda_s)
> \end{array}\right)
> $$
>
> 其中$\overline r(\lambda_s)、\overline g(\lambda_s)、\overline b(\lambda_s)​$是颜色匹配函数。

当进行三色匹配时，有可能出现原色刺激量为负值的情况，这时可以增加一些白色光$（R=G=B=w）​$。这种颜色与期望色比较是正确的，但是不够饱和。

> 饱和是指颜色的纯度。光谱颜色是完全饱和的，但随着白色光的添加，颜色就会欠**饱和**（更柔和。）

仅用三原色不可能再造出所有可能的颜色。

#### 10.2.2 色度空间

三色刺激值不仅描述了颜色，也包含了亮度。通过归一化三色刺激值可以得到色度坐标$r、g、b$：

> $$
> r=\frac{R}{R+G+B},g=\frac{G}{R+G+B},b=\frac{B}{R+G+B}
> $$

> 重心定理：两种颜色的混合色在色度平面上会落在这两种颜色之间的一条直线上。N种颜色的混合色会落入这些颜色所围成的区域中。
>
> 通过混合三原色创造出的任何颜色只能落在由三原色围成的三角形颜色区域中——色域。

CIE在1931年提出一种虚构的非物理三原色系统，称其为$X、Y、Z$。$X、Y$具有0亮度，亮度完全由$Y$提供。

#### 10.2.3 色彩名称

人们通常用名称来描述颜色。许多计算机操作系统包含一个数据库或文件，把人们使用的颜色名称映射为相应的（R、G、B）三色刺激值。

#### 10.2.4 其他颜色空间

颜色空间是一个包含所有可能的三色刺激值的三维空间。

光的明亮程度称为亮度，通常又Y表示。色度加上亮度就构成三维颜色空间，如r-g-Y或x-y-Y。

人们倾向于用两种特征考虑色度：**色相**和**饱和度**。色相是指主要颜色，即最近的光谱颜色；饱和度是指颜色的纯洁性，即缺少混合的白色。

常见的能用色相和饱和度解释的颜色空间有：HSV和CIE L\*C\*h。

#### 10.2.5 两种原色之间的转换



#### 10.2.6 什么是白色

白色的两种定义：

1. 标准日光，在西欧被认定为中午的太阳光，已被CIE表格化为$D_{65}$，可以用6500k的黑体辐射近似。
2. 基于把所有光谱颜色等量混合而成的白色光。

### 10.3 高级议题

#### 10.3.1 颜色的不变性

人具有很强的能力适应场景照明的影响。而机器人观察到的色度随着照明不同会发生变化。

时间和天气影响光线，再加上不同建筑物或树木的反射光，这些因素共同作用改变照明光谱，进而改变物体的亮度与颜色。

#### 10.3.2 白平衡

**照度**是指光源的色温。

白平衡可以通过选择矩阵**J**来实现：

> $$
> \left(\begin{array}{matix}
> R'\\
> G'\\
> B'
> \end{array}\right)=
> 
> {\left(\begin{array}{matix}
> J_R & 0 & 0\\
> 0 & J_G & 0\\
> 0 & 0 & J_B
> \end{array}\right)}
> \left(\begin{array}{matix}
> R\\
> G\\
> B
> \end{array}\right)
> $$

#### 10.3.3 由于吸收的颜色变化

对于水下的物体，水充当了过滤器的作用，不仅影响照射在物体上的照度，也影响从物体反射回到摄像机的反射光。

> 由于水中存在悬浮颗粒对光的散射，会增加对光线的颜色过滤，还会把未经过目标反射的环境光反射到摄像机中。

#### 10.3.4 伽玛



## 第11章 图像形成

眼睛和照相机的成像过程都包含把三维世界投影在二维平面上，这种从三维到二维的转变称为透视投影。

### 11.1 透视变换

